<!doctype html>
<html lang="zh-CN">
<head>
    <base href="/">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="jspm_packages/system.js"></script>
    <script src="app/jspm.config.js"></script>
    <script src="build/thirdparty.js"></script>
    <style>
      #test {
        /*height: 70vh;*/
        width: 95vw;
        border-color: #9c0d0d;
        border-style: dotted;
        margin: 10px auto;
        border-width: 1px;
      }
    </style>
</head>

<body ng-controller="TestCtrl as testCtrl">

  <div class="panel panel-default" style="margin:10px">
    <div class="row" >
      <div class="col-xs-3">
        <button class="btn btn-sm btn-warning" ng-click="testCtrl.clear()">Clear</button>
        <select class="form-control" style="display:inline-block; width:10em"
          ng-model="testCtrl.sample"
          ng-options="sample.title for sample in testCtrl.samples"
          >
        </select>
        <select class="form-control" style="display:inline-block; width:10em"
          ng-model="testCtrl.mode"
          ng-options="m for m in testCtrl.modes"
          ng-change="testCtrl.modeChanged()">
        </select>
      </div>
    </div>
    <hr>
    <div class="row" >
      <div class="col-xs-6">
        <question-markdown start-question-no="20" mode="testCtrl.mode" content="testCtrl.markdownContent">
        </question-markdown>
      </div>
      <div class="col-xs-6"           style="min-height:16em; height:100%">
        <textarea type="text" class="form-control"
          style="min-height:16em; height:100%"
          ng-model="testCtrl.markdownContent">
        </textarea>
      </div>
    </div>
  </div>


  <!-- ================================================================= -->
  <script>
    Promise.all([
      "jquery", "angular", "bootstrap", "markdown-it", "ace"
    ].map(url => System.import(url))).then(function (jQuery, angular) {
      // 2. anular加载之后
      Promise.all([
        "angular",
        "angular-animate",
        "angular-sanitize", "angular-resource",
        "angular-i18n/angular-locale_zh-hans-cn",
        "angular-bootstrap/ui-bootstrap.min.js",
        "angular-bootstrap/ui-bootstrap-tpls.min.js",
        "bootstrap/css/bootstrap.min.css!",
        "animate.css/animate.min.css!"
      ].map(url => System.import(url))).then(function ([angular]) {

        // 3. 在angular等主要模块加载后
        let app = angular.module('mainapp', [
          'ngResource', 'ngSanitize', 'ngAnimate', 'ui.bootstrap'
        ]);

        Promise.all([
          "angular",
          //************************
          //***** 要测试的模块 ******
          'ace',
          'app/test/markdown'
        ].map(url => System.import(url))).then(function ([angualar]) {

          // 在所有的程序库加载后在初始化DOM
          angular.element(document).ready(function() {
              angular.bootstrap(document.body, ['mainapp'], {
                // strictDi: true
              });
          });
        });
      });
    });
  </script>
</body>
</html>
