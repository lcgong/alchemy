<!doctype html>
<html lang="zh-CN">
<head>
    <base href="/">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="jspm_packages/system.js"></script>
    <script src="app/jspm.config.js"></script>
    <script src="build/thirdparty.js"></script>
</head>

<body ng-controller="TestCtrl as testCtrl">

  <div style="margin: 20px auto; width: 50em; display:flex; justify-content: space-around;">
    <category-picker depth="2"
      options="testCtrl.optionsData1"
      on-select="testCtrl.onSelectAbc($selected)" style="flex: 0 0">

      <div class="btn btn-primary">abc</div>
    </category-picker>

    <category-picker depth="1"
      options="testCtrl.optionsData2"
      on-select="testCtrl.onSelectXyz($selected)"  style="flex: 0 0">

      <div class="btn btn-primary">xyz</div>
    </category-picker>
  </div>
  <div style="margin 10px auto; width: 100%; background-color: #eee; ">
    <ul>
      <li> abc : {{testCtrl.abcSelected.label}} </li>
      <li> xyz : {{testCtrl.xyzSelected.label}} </li>
    </ul>
  </div>


  <!-- ================================================================= -->
  <script>
    Promise.all([
      "jquery", "angular", "bootstrap", "markdown-it", "ace"
    ].map(url => System.import(url))).then(function (jQuery, angular) {
      // 2. anular加载之后
      Promise.all([
        "angular",
        "angular-animate",
        "angular-sanitize", "angular-resource",
        "angular-i18n/angular-locale_zh-hans-cn",
        "angular-bootstrap/ui-bootstrap.min.js",
        "angular-bootstrap/ui-bootstrap-tpls.min.js",
        "bootstrap/css/bootstrap.min.css!",
        "animate.css/animate.min.css!"
      ].map(url => System.import(url))).then(function ([angular]) {

        // 3. 在angular等主要模块加载后
        let app = angular.module('mainapp', [
          'ngResource', 'ngSanitize', 'ngAnimate', 'ui.bootstrap'
        ]);

        Promise.all([
          "angular",
          //===== 要测试的模块 ======
          'app/test/category_select'
        ].map(url => System.import(url))).then(function ([angualar]) {

          // 在所有的程序库加载后在初始化DOM
          angular.element(document).ready(function() {
              angular.bootstrap(document.body, ['mainapp'], {
                // strictDi: true
              });
          });
        });
      });
    });
  </script>
</body>
</html>
